(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{19:function(t,e,s){"use strict";s.r(e);var a=s(0),i=s.n(a),o=s(3),n=s.n(o),r=s(1),l=s(5),h=s.n(l);class c extends r.b{constructor(){super(...arguments),this.state={data:[],layout:{},clickedPoints:{x:0,y:0,z:0},measureMode:!1,measurePoints:[],measureLineWidth:0},this.render=()=>{var t=JSON.parse(this.props.args.plot_obj);const e=this.props.args.override_height,s=this.props.args.override_width,a=this.props.args.plot_clicked_point,o=(this.props.args.measure_line_width,this.props.args.clicked_point_size),n=this.props.args.click_event,l=this.props.args.select_event,c=this.props.args.hover_event,d=this.props.args.with_z,u=this.props.args.get_relayout;return r.a.setFrameHeight(e),i.a.createElement(h.a,{data:this.state.data,layout:this.state.layout,onClick:n?this.plotlyEventHandler(d,t,a,o):void 0,onSelected:l?this.plotlyEventHandler(d):void 0,onHover:c?this.plotlyEventHandler(d):void 0,onRelayout:u?this.relayoutEventHandler:void 0,style:{width:s,height:e},className:"stPlotlyChart"})},this.plotlyEventHandler=(t,e,s,a)=>i=>{let o=i.points[0],n=this.state.clickedPoints,l=!1;o.x!==n.x||o.y!==n.y||o.z!==n.z?(console.log("clicked point x diff"),l=!0,this.setState({clickedPoints:{x:o.x,y:o.y,z:o.z}})):l=!1;let h={};if(s&&!0===l){const t=i.points[0];t.curveNumber,t.pointNumber;console.log("current getPoint:",t);let s={x:[t.x],y:[t.y],z:[t.z],mode:"markers",marker:{color:"red"},showlegend:!1,type:void 0!==t.z?"scatter3d":"scatter",name:"Clicked Point",text:["Clicked Point"],hovertemplate:"<b>%{text}</b><br>"+"<b>x: ".concat(t.x.toFixed(3),"</b><br>")+"<b>y: ".concat(t.y.toFixed(3),"</b><br>")+"<b>z: ".concat(t.z.toFixed(3),"</b><extra></extra>")};if(s.marker.size=void 0!==a?a:5,!0===this.state.measureMode){if(this.state.measurePoints.length>=2?(this.state.measurePoints.length=0,this.state.measurePoints.push(s)):this.state.measurePoints.push(s),2===this.state.measurePoints.length){const t=this.state.measurePoints;h=this.createMeasureLine(t),t.push(...h.lines)}console.log("measure points: ",this.state.measurePoints)}!0===this.state.measureMode?e.data.push(...this.state.measurePoints):e.data.push(s),console.log("plotting using: ",e),this.updatePlotState(e)}if(!0===l){let e=[];i.points.forEach((function(s){t?e.push({x:s.x,y:s.y,z:s.z,curveNumber:s.curveNumber,pointNumber:s.pointNumber,pointIndex:s.pointIndex}):e.push({x:s.x,y:s.y,curveNumber:s.curveNumber,pointNumber:s.pointNumber,pointIndex:s.pointIndex})})),!0===this.state.measureMode&&(console.log("measurepoint length: ",this.state.measurePoints.length),e.push({measurePointsX:this.state.measurePoints.map(t=>t.x).filter(t=>1===t.length).flat(),measurePointsY:this.state.measurePoints.map(t=>t.y).filter(t=>1===t.length).flat(),measurePointsZ:this.state.measurePoints.map(t=>t.z).filter(t=>1===t.length).flat(),dx:1===this.state.measurePoints.length?0:parseFloat(h.distances[0].toFixed(3)),dy:1===this.state.measurePoints.length?0:parseFloat(h.distances[1].toFixed(3)),dz:1===this.state.measurePoints.length?0:parseFloat(h.distances[2].toFixed(3)),dxyz:1===this.state.measurePoints.length?0:parseFloat(h.distances[3].toFixed(3)),dxy:1===this.state.measurePoints.length?0:parseFloat(h.distances[4].toFixed(3)),dxz:1===this.state.measurePoints.length?0:parseFloat(h.distances[5].toFixed(3)),dyz:1===this.state.measurePoints.length?0:parseFloat(h.distances[6].toFixed(3))})),r.a.setComponentValue(JSON.stringify(e))}},this.createMeasureLine=t=>{const e=Math.abs(t[1].x-t[0].x),s=Math.abs(t[1].y-t[0].y),a=Math.abs(t[1].z-t[0].z),i=Math.sqrt(Math.pow(e,2)+Math.pow(s,2)+Math.pow(a,2)),o=Math.sqrt(e*e+s*s),n=Math.sqrt(e*e+a*a),r=Math.sqrt(s*s+a*a);return{lines:[{x:[...t[0].x,...t[1].x],y:[...t[0].y,...t[1].y],z:[...t[0].z,...t[1].z],mode:"lines",line:{color:"purple",width:this.state.measureLineWidth},type:"scatter3d",name:"Distance",text:["Point 1","Point 2"],hovertemplate:"<b>%{text}</b><br>"+"<b>Measured distance: ".concat(i.toFixed(3),"m</b><br>")+"<b>\u0394XY: ".concat(o.toFixed(3),"</b><br>")+"<b>\u0394XZ: ".concat(n.toFixed(3),"</b><br>")+"<b>\u0394YZ: ".concat(r.toFixed(3),"</b><extra></extra>")},{x:[...t[0].x,...t[1].x],y:[...t[0].y,...t[0].y],z:[...t[0].z,...t[0].z],mode:"lines",line:{color:"red",width:this.state.measureLineWidth},type:"scatter3d",name:"Distance X",text:["Point 1","Point 2"],hovertemplate:"<b>Measured distance X: ".concat(e.toFixed(3),"m</b><extra></extra>")},{x:[...t[1].x,...t[1].x],y:[...t[0].y,...t[1].y],z:[...t[0].z,...t[0].z],mode:"lines",line:{color:"green",width:this.state.measureLineWidth},type:"scatter3d",name:"Distance Y",text:["Point 1","Point 2"],hovertemplate:"<b>Measured distance Y: ".concat(s.toFixed(3),"m</b><extra></extra>")},{x:[...t[1].x,...t[1].x],y:[...t[1].y,...t[1].y],z:[...t[0].z,...t[1].z],mode:"lines",line:{color:"blue",width:4},type:"scatter3d",name:"Distance Z",text:["Point 1","Point 2"],hovertemplate:"<b>Measured distance X: ".concat(a.toFixed(3),"m</b><extra></extra>")}],distances:[e,s,a,i,o,n,r]}},this.updatePlotState=t=>{this.setState({data:t.data})},this.relayoutEventHandler=t=>{if(console.log("relayout callback"),t&&t["scene.camera"]){const e=t["scene.camera"].eye;console.log("current eye",e);const s={cameraLayout:{x:e.x,y:e.y,z:e.z}};r.a.setComponentValue(JSON.stringify(s))}}}componentDidMount(){let t=JSON.parse(this.props.args.plot_obj),e=this.props.args.measure_mode,s=this.props.args.measure_line_width;t.layout.uirevision="true",console.log("current plot layout: ",t.layout),this.setState({data:t.data,layout:t.layout,clickedPoints:{x:0,y:0,z:0},measureMode:e,measurePoints:[],measureLineWidth:s})}}var d=Object(r.c)(c);n.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(d,null)),document.getElementById("root"))},6:function(t,e,s){t.exports=s(19)}},[[6,1,2]]]);
//# sourceMappingURL=main.47564b5d.chunk.js.map